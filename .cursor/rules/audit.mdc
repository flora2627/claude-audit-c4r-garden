---
alwaysApply: true
---
## 二、审计产出与存储规范

1. **Findings 存储约定**
   - 所有审计发现（finding）必须保存在 `finds/` 目录。
   - 文件命名统一为：`finding_{id}.md`
     - 示例： [finds/finding_1.md](mdc:finds/finding_1.md)

2. **审计反馈文件**
   - 全局审计反馈、总结与元信息统一写入根目录：
     - [pk.md](mdc:pk.md)

3. **审计前必读材料（强约束）**
   - 在开始任何一轮审计工作前，必须先完成以下阅读：
     - `finds/` 目录下全部 `finding_{id}.md`（如存在）  
       → 只提取**关键记忆点**，避免重复关注同一问题。
     - 根目录 [pk.md](mdc:pk.md)  
       → 只保留核心结论和重要背景，不做逐字记忆。
     - `acc_modeling/` 目录全部内容  
       → 重点理解变量恒等式、会计不变量和关键指标，不强求细节全记住。
     - `role_modeling/` 目录全部内容  
       → 建立“角色 ↔ 权限/建模文件”的映射认知，细节可在审计中按需再查。

4. **审计过程行为约束**
   - 不给出任何修复建议，只负责指出问题本身及其影响。
   - 当对某一思路或潜在漏洞的**置信度低于 80%** 时：
     - 立即放弃该思路，切换到新的分析路径。
   - 上述阅读与行为要求均为**强约束**，未完成前不得开始正式审计。

---

## 三、审计迭代与 Findings 使用规则

1. **基于历史结果进行新一轮审计**
   - 每一轮新的审计都必须建立在对以往 `finds/` 中 findings 的理解之上。
   - 对于已被标记为 **invalid** 或 **已覆盖** 的 finding：
     - 不再投入审计精力进行复审或复现。
   - `finds/` 目录中的 finding 文件，视为当前代码版本下的**权威审计口径**，不存在“整份历史报告需要重新验证”的工作模式。

2. **突破目标**
   - `acc_modeling/` 下的所有不变量与会计恒等式：
     - 作为审计的主要突破目标之一，主动寻找可能破坏这些不变量的调用路径或状态组合。
   - `role_modeling/` 下与普通权限相关的建模：
     - 作为权限突破的主要目标，主动寻找“普通用户权限被放大或越权”的可能路径。

3. **迭代工作流（强制执行）**
   1) 列出并阅读 `finds/` 下所有 `finding_{id}.md`，逐项标注是否为 invalid / 已覆盖。  
   2) 对 invalid / 已覆盖条目不再进行复审、复现或轻微变体的重复探索。  
   3) 将主要精力集中在**未覆盖的代码/路径**上，包括：
      - 新文件、新函数；
      - 不同参数组合引出的新路径；
      - 之前从未深入分析过的调用链。  
   4) 如果发现全新的问题：
      - 新增一个 `finding_{new_id}.md` 文件，避免与已有 finding 重复。
   5) 新增 finding 前，检查目标文件名是否已经存在：
      - 若存在，则将 id + 1，直到找到不存在的 id，避免覆盖旧文件。

---

## 四、模式切换总结

- 当用户让你“审计、review、找漏洞、做静态分析”时：  
  → 进入 **审计流程模式**，必须严格遵守本提示词。

- 当用户让你“写 PoC、跑测试复现、验证某份报告是否真实”时：  
  → 进入 **PoC/验证模式**，可以忽略本提示词中的审计流程规则，只关注执行与验证本身。